# Блог

## Сервер

## Быстрый старт

### Запуск сервера
1) Установите свои значения в конфиге **config.json**:

Поля конфига:
 - *db_user*: Имя пользователя Postgres
 - *db_password*: Пароль пользователя Postgres
 - *db_name*: Имя базы данных
 - *jwtSecretKey*: секретный ключ, который используется для создания и проверки JWT токенов
 
2) Зарегестрируйте пользователя на странице **/register**
3) Дайте данному пользователю права админа, записав его логин в список логинов админов в конфиге **admins.json**:
```
{
  "admins": [
    {
      "login": "ADMIN_USERNAME" // Insert admin's username here
    }
  ]
}
```
4) Запустите сервер

Конфиги подхватятся автоматически.

В папке с сервером (server):
```
go build
./server
```

---

### Запуск тестов
1) Установите свои значения в конфиге **testConfig.json**

Данный конфиг играет ту же роль и имеет ту же структуру, что и конфиг, использующийся для обычной работы сервера.

Однако, так как он используется для работы тестового сервера и тесты не должны мешать работе обычного сервера, 
следует установить такие значения, чтобы значения двух конфигов не пересекались.

2) Запустите тесты:

```
go test -v
```

---

## Передача своих конфигов

### Описание конфигов сервера
Для того, чтобы запустить сервер с своими конфигами, необходимо передать следующие аргументы в программу:
 - *config* - местоположение конфига сервера. 

**Стандартный путь:** *configs/config.json*
 - *admins* - местоположение конфига с списком админов, которые имеют такие привилегии, как создавать, 
 изменять и удалять посты.

**Стандартный путь:** *configs/admins.json*

--- 

#### Разберем каждый конфиг

1) **Config**

Данный конфиг имеет следующий вид:
```
{
  "db_user": "postgres",
  "db_password": "postgres",
  "db_name": "postgres",
  "jwtSecretKey": "superSecretKey"
}
```
Поля конфига:
 - *db_user*: Имя пользователя Postgres
 - *db_password*: Пароль пользователя Postgres
 - *db_name*: Имя базы данных
 - *jwtSecretKey*: секретный ключ, который используется для создания и проверки JWT токенов
 
2) **Admins**

Данный конфиг имеет следующий вид:
```
{
  "admins": [
    {
      "login": "admin1Login"
    },
    {
      "login": "admin2Login"
    }
  ]
}
```
Поля конфига:
 - *admins*: Список пользователей, которые имеют такие привилегии, как создавать, изменять и удалять посты.
 
### Запуск сервера с указанием собественных конфигов
```
go build
./ server -config=/path/to/my/ServerConfig.json -admins=/path/to/my/adminsConfig.json
```

---

## Тесты
### Описание конфигов тестов
Тесты также требуют передачи конфига сервера, однако не нуждаются в передаче списка админов, так как необхоидмые для 
тестинга админы и конфиг создаются автоматически. Не рекомендуется использовать тот же конфиг сервера, что и используется
для обычной работы сервера.

Для того, чтобы запустить тесты сервера, необходимо передать следующие аргументы в программу:
 - *config* - местоположение конфига сервера для тестинга. 
 
**Стандартный путь:** *configs/testConfig.json*

### Запуск тестов с указанием собественных конфигов
```
go test -v -config=/path/to/my/testConfig.json
```